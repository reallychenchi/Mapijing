# Requirement
这是一个聊天虚拟人应用，提供语音聊天功能，它的目的是给用户提供情绪价值，帮助用户获得良好的情绪感受。搭建在web上，通过浏览器实现。

# 界面描述
要求适配手机和电脑两种形式。有两个区域，虚拟人区域，文字区域

## 虚拟人区域
展示虚拟头像，有四种：默认陪伴、共情倾听、安慰支持、轻松愉悦，分别对应四张图片，只要图片就行了，不需要任何背景。会有一个耳朵图标，就用emoji图形的耳朵，展示在头像右上角，注意是头像图片右上角，不是区域右上角。如果用户没有回应，就闪动这个耳朵图标提示用户说话。

## 文字区域
展示虚拟人说话内容，或者用户语音识别出来内容，谁说话就展示谁的内容。只展示当前说话内容，流式输出，上下滚动。只要文字就可以了，不需要任何背景

## 手机
手机情况下布局分成两部分，上下各占二分之一，不出现滚动条：
顶部展示虚拟头像，居中展示
底部是文字区域

## 电脑
电脑情况下分成左右两部分，分别是虚拟头像、文字区域

# 后端描述

## 大模型
语音识别和文字转语音按照 Reference 
大语言模型使用 
curl https://api.deepseek.com/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer sk-903a962786f34773a1680f6fb6fad64d" \
  -d '{
        "model": "deepseek-chat",
        "messages": [
          {"role": "system", "content": "You are a helpful assistant."},
          {"role": "user", "content": "Hello!"}
        ],
        "stream": false
      }'

## 接口
有 对话接口、语音识别接口、文字转语音接口

## 语音识别接口
前端获取语音，流式接口，识别为文字下发到前端，前端收到以后流式展示在文字区域，此时也要下发对应的情感状态：默认陪伴、共情倾听、安慰支持、轻松愉悦，前端根据不同的状态展示不同的虚拟人头像

## 文字转语音接口
大模型返回对话内容以后，后端调用该接口转换成语音，下发到前端播放，同时前端也要流式展示文字

## 对话接口
对话接口不需要前端调用，在后端调用，语音识别接口收到，并且转换完成以后，提交内容给LLM，大模型返回以后下发给前端

# 大模型提示词
现在简单一点，系统提示词式：你是一个善解人意的小马，帮助对方聊天。返回格式要求用 <content> </content> <emotion></emotion> 标签标记，content中间是返回得对话，emotion中间是当前小马的表情，有  默认陪伴、共情倾听、安慰支持、轻松愉悦 四种，其中 默认陪伴 是默认状态。

# Reference
语音转文字、文字转语音参考代码工程位于 ../ScriptBuddy/
语音转文字、文字转语音参考文档位于 ../ScriptBuddy/doc/TTS_ASR_Configuration_Guide.md
../ScriptBuddy/doc/下的文档和文件也可以根据情况参考，但是务必以上述参考代码工程的代码实现 和 参考文档为主，因为参考工程的代码是经过测试的，参考文档是以参考工程为基础生成的
